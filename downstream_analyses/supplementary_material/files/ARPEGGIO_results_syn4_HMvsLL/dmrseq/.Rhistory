HM_TKSG1_v_RS7G4_DMG_CHH_hal <- read.delim("ARPEGGIO_results_tks1Vsyn4_HM/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_1.txt")
HM_lyrG1_v_RS7G1_DMG_CG <- read.delim("ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
HM_lyrG1_v_RS7G1_DMG_CHG <- read.delim("ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
HM_lyrG1_v_RS7G1_DMG_CHH <- read.delim("ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
HM_lyrG1_v_RS7G4_DMG_CG <- read.delim("ARPEGGIO_results_syn4Vpro1_HM/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
HM_lyrG1_v_RS7G4_DMG_CHG <- read.delim("ARPEGGIO_results_syn4Vpro1_HM/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
HM_lyrG1_v_RS7G4_DMG_CHH <- read.delim("ARPEGGIO_results_syn4Vpro1_HM/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
HM_RS7G1_v_RS7G4_DMG_CG_lyr <- read.delim("ARPEGGIO_results_syn4v1_HM/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
HM_RS7G1_v_RS7G4_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_syn4v1_HM/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
HM_RS7G1_v_RS7G4_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_syn4v1_HM/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
HM_ALKG1_v_lyrG1_DMG_CG <- read.delim("ARPEGGIO_results_alk1Vpro1_HM/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
HM_ALKG1_v_lyrG1_DMG_CHG <- read.delim("ARPEGGIO_results_alk1Vpro1_HM/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
HM_ALKG1_v_lyrG1_DMG_CHH <- read.delim("ARPEGGIO_results_alk1Vpro1_HM/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
HM_ALKG1_v_RS7G1_DMG_CG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn1_HM/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
HM_ALKG1_v_RS7G1_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn1_HM/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
HM_ALKG1_v_RS7G1_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn1_HM/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
HM_ALKG1_v_RS7G4_DMG_CG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn4_HM/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
HM_ALKG1_v_RS7G4_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn4_HM/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
HM_ALKG1_v_RS7G4_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn4_HM/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
HM_TKSG1_v_lyrG1_DMG_CG <- read.delim("ARPEGGIO_results_tks1Vpro1_HM/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
HM_TKSG1_v_lyrG1_DMG_CHG <- read.delim("ARPEGGIO_results_tks1Vpro1_HM/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
HM_TKSG1_v_lyrG1_DMG_CHH <- read.delim("ARPEGGIO_results_tks1Vpro1_HM/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
HM_TKSG1_v_RS7G1_DMG_CG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn1_HM/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
HM_TKSG1_v_RS7G1_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn1_HM/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
HM_TKSG1_v_RS7G1_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn1_HM/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
HM_TKSG1_v_RS7G4_DMG_CG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn4_HM/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
HM_TKSG1_v_RS7G4_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn4_HM/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
HM_TKSG1_v_RS7G4_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn4_HM/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
LL_halG1_v_RS7G1_DMG_CG <- read.delim("ARPEGGIO_results_syn1Vpro1_LL/dmrseq/CG_context/DM_genes_parent1_v_allo_CG_context.txt")
LL_halG1_v_RS7G1_DMG_CHG <- read.delim("ARPEGGIO_results_syn1Vpro1_LL/dmrseq/CHG_context/DM_genes_parent1_v_allo_CHG_context.txt")
LL_halG1_v_RS7G1_DMG_CHH <- read.delim("ARPEGGIO_results_syn1Vpro1_LL/dmrseq/CHH_context/DM_genes_parent1_v_allo_CHH_context.txt")
LL_halG1_v_RS7G4_DMG_CG <- read.delim("ARPEGGIO_results_syn4Vpro1_LL/dmrseq/CG_context/DM_genes_parent1_v_allo_CG_context.txt")
LL_halG1_v_RS7G4_DMG_CHG <- read.delim("ARPEGGIO_results_syn4Vpro1_LL/dmrseq/CHG_context/DM_genes_parent1_v_allo_CHG_context.txt")
LL_halG1_v_RS7G4_DMG_CHH <- read.delim("ARPEGGIO_results_syn4Vpro1_LL/dmrseq/CHH_context/DM_genes_parent1_v_allo_CHH_context.txt")
LL_RS7G1_v_RS7G4_DMG_CG_hal <- read.delim("ARPEGGIO_results_syn4v1_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_1.txt")
LL_RS7G1_v_RS7G4_DMG_CHG_hal <- read.delim("ARPEGGIO_results_syn4v1_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_1.txt")
LL_RS7G1_v_RS7G4_DMG_CHH_hal <- read.delim("ARPEGGIO_results_syn4v1_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_1.txt")
LL_ALKG1_v_halG1_DMG_CG <- read.delim("ARPEGGIO_results_alk1Vpro1_LL/dmrseq/CG_context/DM_genes_parent1_v_allo_CG_context.txt")
LL_ALKG1_v_halG1_DMG_CHG <- read.delim("ARPEGGIO_results_alk1Vpro1_LL/dmrseq/CHG_context/DM_genes_parent1_v_allo_CHG_context.txt")
LL_ALKG1_v_halG1_DMG_CHH <- read.delim("ARPEGGIO_results_alk1Vpro1_LL/dmrseq/CHH_context/DM_genes_parent1_v_allo_CHH_context.txt")
LL_ALKG1_v_RS7G1_DMG_CG_hal <- read.delim("ARPEGGIO_results_alk1Vsyn1_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_1.txt")
LL_ALKG1_v_RS7G1_DMG_CHG_hal <- read.delim("ARPEGGIO_results_alk1Vsyn1_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_1.txt")
LL_ALKG1_v_RS7G1_DMG_CHH_hal <- read.delim("ARPEGGIO_results_alk1Vsyn1_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_1.txt")
LL_ALKG1_v_RS7G4_DMG_CG_hal <- read.delim("ARPEGGIO_results_alk1Vsyn4_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_1.txt")
LL_ALKG1_v_RS7G4_DMG_CHG_hal <- read.delim("ARPEGGIO_results_alk1Vsyn4_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_1.txt")
LL_ALKG1_v_RS7G4_DMG_CHH_hal <- read.delim("ARPEGGIO_results_alk1Vsyn4_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_1.txt")
LL_TKSG1_v_halG1_DMG_CG <- read.delim("ARPEGGIO_results_tks1Vpro1_LL/dmrseq/CG_context/DM_genes_parent1_v_allo_CG_context.txt")
LL_TKSG1_v_halG1_DMG_CHG <- read.delim("ARPEGGIO_results_tks1Vpro1_LL/dmrseq/CHG_context/DM_genes_parent1_v_allo_CHG_context.txt")
LL_TKSG1_v_halG1_DMG_CHH <- read.delim("ARPEGGIO_results_tks1Vpro1_LL/dmrseq/CHH_context/DM_genes_parent1_v_allo_CHH_context.txt")
LL_TKSG1_v_RS7G1_DMG_CG_hal <- read.delim("ARPEGGIO_results_tks1Vsyn1_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_1.txt")
LL_TKSG1_v_RS7G1_DMG_CHG_hal <- read.delim("ARPEGGIO_results_tks1Vsyn1_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_1.txt")
LL_TKSG1_v_RS7G1_DMG_CHH_hal <- read.delim("ARPEGGIO_results_tks1Vsyn1_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_1.txt")
LL_TKSG1_v_RS7G4_DMG_CG_hal <- read.delim("ARPEGGIO_results_tks1Vsyn4_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_1.txt")
LL_TKSG1_v_RS7G4_DMG_CHG_hal <- read.delim("ARPEGGIO_results_tks1Vsyn4_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_1.txt")
LL_TKSG1_v_RS7G4_DMG_CHH_hal <- read.delim("ARPEGGIO_results_tks1Vsyn4_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_1.txt")
LL_lyrG1_v_RS7G1_DMG_CG <- read.delim("ARPEGGIO_results_syn1Vpro1_LL/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
LL_lyrG1_v_RS7G1_DMG_CHG <- read.delim("ARPEGGIO_results_syn1Vpro1_LL/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
LL_lyrG1_v_RS7G1_DMG_CHH <- read.delim("ARPEGGIO_results_syn1Vpro1_LL/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
LL_lyrG1_v_RS7G4_DMG_CG <- read.delim("ARPEGGIO_results_syn4Vpro1_LL/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
LL_lyrG1_v_RS7G4_DMG_CHG <- read.delim("ARPEGGIO_results_syn4Vpro1_LL/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
LL_lyrG1_v_RS7G4_DMG_CHH <- read.delim("ARPEGGIO_results_syn4Vpro1_LL/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
LL_RS7G1_v_RS7G4_DMG_CG_lyr <- read.delim("ARPEGGIO_results_syn4v1_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
LL_RS7G1_v_RS7G4_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_syn4v1_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
LL_RS7G1_v_RS7G4_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_syn4v1_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
LL_ALKG1_v_lyrG1_DMG_CG <- read.delim("ARPEGGIO_results_alk1Vpro1_LL/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
LL_ALKG1_v_lyrG1_DMG_CHG <- read.delim("ARPEGGIO_results_alk1Vpro1_LL/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
LL_ALKG1_v_lyrG1_DMG_CHH <- read.delim("ARPEGGIO_results_alk1Vpro1_LL/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
LL_ALKG1_v_RS7G1_DMG_CG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn1_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
LL_ALKG1_v_RS7G1_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn1_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
LL_ALKG1_v_RS7G1_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn1_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
LL_ALKG1_v_RS7G4_DMG_CG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn4_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
LL_ALKG1_v_RS7G4_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn4_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
LL_ALKG1_v_RS7G4_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_alk1Vsyn4_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
LL_TKSG1_v_lyrG1_DMG_CG <- read.delim("ARPEGGIO_results_tks1Vpro1_LL/dmrseq/CG_context/DM_genes_parent2_v_allo_CG_context.txt")
LL_TKSG1_v_lyrG1_DMG_CHG <- read.delim("ARPEGGIO_results_tks1Vpro1_LL/dmrseq/CHG_context/DM_genes_parent2_v_allo_CHG_context.txt")
LL_TKSG1_v_lyrG1_DMG_CHH <- read.delim("ARPEGGIO_results_tks1Vpro1_LL/dmrseq/CHH_context/DM_genes_parent2_v_allo_CHH_context.txt")
LL_TKSG1_v_RS7G1_DMG_CG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn1_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
LL_TKSG1_v_RS7G1_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn1_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
LL_TKSG1_v_RS7G1_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn1_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
LL_TKSG1_v_RS7G4_DMG_CG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn4_LL/dmrseq/CG_context/DM_genes_A_v_B_polyploid_CG_context_2.txt")
LL_TKSG1_v_RS7G4_DMG_CHG_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn4_LL/dmrseq/CHG_context/DM_genes_A_v_B_polyploid_CHG_context_2.txt")
LL_TKSG1_v_RS7G4_DMG_CHH_lyr <- read.delim("ARPEGGIO_results_tks1Vsyn4_LL/dmrseq/CHH_context/DM_genes_A_v_B_polyploid_CHH_context_2.txt")
setwd("/Users/ste/OneDrive/PhD/Project/Chapter_3/Reports/RNAseqDEG/")
HM_halG1_v_RS7G1_DEG <- read.delim("HM_halG1_v_RS7G1_DEG.txt")
HM_halG1_v_RS7G4_DEG <- read.delim("HM_halG1_v_RS7G4_DEG.txt")
HM_RS7G1_v_RS7G4_hal_DEG <- read.delim("HM_RS7G1_v_G4_hal_DEG.txt")
HM_ALKG1_v_halG1_DEG <- read.delim("HM_ALKG1_v_halG1_DEG.txt")
HM_ALKG1_v_RS7G1_hal_DEG <- read.delim("HM_ALKG1_v_RS7G1_hal_DEG.txt")
HM_ALKG1_v_RS7G4_hal_DEG <- read.delim("HM_ALKG1_v_RS7G4_hal_DEG.txt")
HM_TKSG1_v_halG1_DEG <- read.delim("HM_TKSG1_v_halG1_DEG.txt")
HM_TKSG1_v_RS7G1_hal_DEG <- read.delim("HM_TKSG1_v_RS7G1_hal_DEG.txt")
HM_TKSG1_v_RS7G4_hal_DEG <- read.delim("HM_TKSG1_v_RS7G4_hal_DEG.txt")
HM_lyrG1_v_RS7G1_DEG <- read.delim("HM_lyrG1_v_RS7G1_DEG.txt")
HM_lyrG1_v_RS7G4_DEG <- read.delim("HM_lyrG1_v_RS7G4_DEG.txt")
HM_RS7G1_v_RS7G4_lyr_DEG <- read.delim("HM_RS7G1_v_G4_lyr_DEG.txt")
HM_ALKG1_v_lyrG1_DEG <- read.delim("HM_ALKG1_v_lyrG1_DEG.txt")
HM_ALKG1_v_RS7G1_lyr_DEG <- read.delim("HM_ALKG1_v_RS7G1_lyr_DEG.txt")
HM_ALKG1_v_RS7G4_lyr_DEG <- read.delim("HM_ALKG1_v_RS7G4_lyr_DEG.txt")
HM_TKSG1_v_lyrG1_DEG <- read.delim("HM_TKSG1_v_lyrG1_DEG.txt")
HM_TKSG1_v_RS7G1_lyr_DEG <- read.delim("HM_TKSG1_v_RS7G1_lyr_DEG.txt")
HM_TKSG1_v_RS7G4_lyr_DEG <- read.delim("HM_TKSG1_v_RS7G4_lyr_DEG.txt")
LL_halG1_v_RS7G1_DEG <- read.delim("LL_halG1_v_RS7G1_DEG.txt")
LL_halG1_v_RS7G4_DEG <- read.delim("LL_halG1_v_RS7G4_DEG.txt")
LL_RS7G1_v_RS7G4_hal_DEG <- read.delim("LL_RS7G1_v_G4_hal_DEG.txt")
LL_ALKG1_v_halG1_DEG <- read.delim("LL_ALKG1_v_halG1_DEG.txt")
LL_ALKG1_v_RS7G1_hal_DEG <- read.delim("LL_ALKG1_v_RS7G1_hal_DEG.txt")
LL_ALKG1_v_RS7G4_hal_DEG <- read.delim("LL_ALKG1_v_RS7G4_hal_DEG.txt")
LL_TKSG1_v_halG1_DEG <- read.delim("LL_TKSG1_v_halG1_DEG.txt")
LL_TKSG1_v_RS7G1_hal_DEG <- read.delim("LL_TKSG1_v_RS7G1_hal_DEG.txt")
LL_TKSG1_v_RS7G4_hal_DEG <- read.delim("LL_TKSG1_v_RS7G4_hal_DEG.txt")
LL_lyrG1_v_RS7G1_DEG <- read.delim("LL_lyrG1_v_RS7G1_DEG.txt")
LL_lyrG1_v_RS7G4_DEG <- read.delim("LL_lyrG1_v_RS7G4_DEG.txt")
LL_RS7G1_v_RS7G4_lyr_DEG <- read.delim("LL_RS7G1_v_G4_lyr_DEG.txt")
LL_ALKG1_v_lyrG1_DEG <- read.delim("LL_ALKG1_v_lyrG1_DEG.txt")
LL_ALKG1_v_RS7G1_lyr_DEG <- read.delim("LL_ALKG1_v_RS7G1_lyr_DEG.txt")
LL_ALKG1_v_RS7G4_lyr_DEG <- read.delim("LL_ALKG1_v_RS7G4_lyr_DEG.txt")
LL_TKSG1_v_lyrG1_DEG <- read.delim("LL_TKSG1_v_lyrG1_DEG.txt")
LL_TKSG1_v_RS7G1_lyr_DEG <- read.delim("LL_TKSG1_v_RS7G1_lyr_DEG.txt")
LL_TKSG1_v_RS7G4_lyr_DEG <- read.delim("LL_TKSG1_v_RS7G4_lyr_DEG.txt")
consolidate <- function(DMG1, DMG2, DMG3){
new_DMG <- rbind(DMG1, DMG2, DMG3)
new_DMG <- arrange(new_DMG, geneID)
new_DMG <- new_DMG[!duplicated(new_DMG$geneID),]
return(new_DMG)
}
View(HM_halG1_v_RS7G1_DMG_CG)
?overlap
HM_RS7G1_v_halG1_overlap <- intersect(HM_halG1_v_RS7G1_DMG_CG$geneID,
HM_halG1_v_RS7G1_DEG$geneID)
head(HM_RS7G1_v_halG1_overlap)
HM_RS7G1_v_halG1_diffmeth <- HM_halG1_v_RS7G1_DMG_CG[HM_RS7G1_v_halG1_overlap %in% HM_halG1_v_RS7G1_DMG_CG$geneID,]
nrow(HM_RS7G1_v_halG1_overlap)
length(HM_RS7G1_v_halG1_overlap)
nrow(HM_RS7G1_v_halG1_diffmeth)
HM_RS7G1_v_halG1_overlap %in% HM_halG1_v_RS7G1_DMG_CG$geneID
HM_halG1_v_RS7G1_DMG_CG$geneID %in% HM_RS7G1_v_halG1_overlap
HM_RS7G1_v_halG1_diffmeth <- HM_halG1_v_RS7G1_DMG_CG[HM_halG1_v_RS7G1_DMG_CG$geneID %in% HM_RS7G1_v_halG1_overlap,]
nrow(HM_RS7G1_v_halG1_diffmeth)
length(HM_RS7G1_v_halG1_overlap)
duplicated(HM_halG1_v_RS7G1_DMG_CG$geneID)
HM_halG1_v_RS7G1_DMG_CG$geneID[830]
HM_halG1_v_RS7G1_DMG_CG$geneID[831]
HM_RS7G1_v_halG1_diffexp <- HM_halG1_v_RS7G1_DEG[HM_halG1_v_RS7G1_DEG$geneID %in% HM_RS7G1_v_halG1_overlap,]
HM_RS7G1_v_halG1_diffexp
?merge
HM_RS7G1_v_halG1_merge <- merge(HM_RS7G1_v_halG1_diffmeth, HM_RS7G1_v_halG1_diffmeth, by = "geneID")
View(HM_RS7G1_v_halG1_merge)
HM_RS7G1_v_halG1_merge <- merge(HM_RS7G1_v_halG1_diffmeth, HM_RS7G1_v_halG1_diffexp, by = "geneID")
View(HM_RS7G1_v_halG1_merge)
HM_syn1Vpro1_raw <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CG_context/parent1_v_allo_sig_diff.txt")
View(HM_syn1Vpro1_raw)
match(HM_syn1Vpro1_raw$start, HM_RS7G1_v_halG1_merge$region_start)
!is.na(match(HM_syn1Vpro1_raw$start, HM_RS7G1_v_halG1_merge$region_start))
sum(!is.na(match(HM_syn1Vpro1_raw$start, HM_RS7G1_v_halG1_merge$region_start)))
na.omit(match(HM_syn1Vpro1_raw$start, HM_RS7G1_v_halG1_merge$region_start))
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
match_start <- match(HM_syn1Vpro1_raw$start, HM_RS7G1_v_halG1_merge$region_start)
match_start <- na.omit(match(HM_syn1Vpro1_raw$start, HM_RS7G1_v_halG1_merge$region_start))
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
had(match_start)
head(match_start)
HM_syn1Vpro1_raw$rawDiff[139]
HM_syn1Vpro1_raw$rawDiff[66]
head(rawDiff)
HM_RS7G1_v_halG1_final <- mutate(HM_RS7G1_v_halG1_merge, rawDiff =
rawDiff)
match_start <- match(HM_RS7G1_v_halG1_merge$region_start,
HM_syn1Vpro1_raw$start)
head(match_start)
HM_RS7G1_v_halG1_merge$region_start[1]
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
HM_RS7G1_v_halG1_final <- mutate(HM_RS7G1_v_halG1_merge, rawDiff =
rawDiff)
ggplot(data = HM_RS7G1_v_halG1_merge, mapping = aes(x = logFC,
y = rawDiff)) +
geom_point()
ggplot(data = HM_RS7G1_v_halG1_merge, mapping = aes(x = logFC,
y = rawDiff)) +
geom_point() +
geom_smooth(method = lm)
HM_syn1Vpro1_raw_lyr <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CG_context/parent2_v_allo_sig_diff.txt")
match_start <- match(HM_RS7G1_v_lyrG1_merge$region_start,
HM_syn1Vpro1_raw_lyr$start)
HM_syn1Vpro1_raw <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CG_context/parent2_v_allo_sig_diff.txt")
match_start <- match(HM_RS7G1_v_halG1_merge$region_start,
HM_syn1Vpro1_raw$start)
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
HM_RS7G1_v_halG1_final <- mutate(HM_RS7G1_v_halG1_merge, rawDiff =
rawDiff)
ggplot(data = HM_RS7G1_v_halG1_merge, mapping = aes(x = logFC,
y = rawDiff)) +
geom_point() +
geom_smooth(method = lm)
HM_RS7G1_v_lyrG1_overlap <- intersect(HM_lyrG1_v_RS7G1_DMG_CG$geneID,
HM_lyrG1_v_RS7G1_DEG$geneID)
HM_RS7G1_v_lyrG1_diffmeth <- HM_lyrG1_v_RS7G1_DMG_CG[HM_lyrG1_v_RS7G1_DMG_CG$geneID %in% HM_RS7G1_v_lyrG1_overlap,]
HM_RS7G1_v_lyrG1_diffexp <- HM_lyrG1_v_RS7G1_DEG[HM_lyrG1_v_RS7G1_DEG$geneID %in% HM_RS7G1_v_lyrG1_overlap,]
HM_RS7G1_v_lyrG1_merge <- merge(HM_RS7G1_v_lyrG1_diffmeth, HM_RS7G1_v_lyrG1_diffexp, by = "geneID")
HM_syn1Vpro1_raw <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CG_context/parent2_v_allo_sig_diff.txt")
match_start <- match(HM_RS7G1_v_lyrG1_merge$region_start,
HM_syn1Vpro1_raw$start)
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
HM_RS7G1_v_lyrG1_final <- mutate(HM_RS7G1_v_lyrG1_merge, rawDiff =
rawDiff)
ggplot(data = HM_RS7G1_v_lyrG1_merge, mapping = aes(x = logFC,
y = rawDiff)) +
geom_point() +
geom_smooth(method = lm)
HM_RS7G4_v_halG1_overlap <- intersect(HM_halG1_v_RS7G4_DMG_CG$geneID,
HM_halG1_v_RS7G4_DEG$geneID)
HM_RS7G4_v_halG1_diffmeth <- HM_halG1_v_RS7G4_DMG_CG[HM_halG1_v_RS7G4_DMG_CG$geneID %in% HM_RS7G4_v_halG1_overlap,]
HM_RS7G4_v_halG1_diffexp <- HM_halG1_v_RS7G4_DEG[HM_halG1_v_RS7G4_DEG$geneID %in% HM_RS7G4_v_halG1_overlap,]
HM_RS7G4_v_halG1_merge <- merge(HM_RS7G4_v_halG1_diffmeth, HM_RS7G4_v_halG1_diffexp, by = "geneID")
HM_syn1Vpro1_raw <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CG_context/parent1_v_allo_sig_diff.txt")
HM_syn1Vpro1_raw <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn4Vpro1_HM/dmrseq/CG_context/parent1_v_allo_sig_diff.txt")
match_start <- match(HM_RS7G4_v_halG1_merge$region_start,
HM_syn1Vpro1_raw$start)
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
HM_RS7G4_v_halG1_final <- mutate(HM_RS7G4_v_halG1_merge, rawDiff =
rawDiff)
ggplot(data = HM_RS7G4_v_halG1_merge, mapping = aes(x = logFC,
y = rawDiff)) +
geom_point() +
geom_smooth(method = lm)
HM_RS7G4_v_lyrG1_overlap <- intersect(HM_lyrG1_v_RS7G4_DMG_CG$geneID,
HM_lyrG1_v_RS7G4_DEG$geneID)
HM_RS7G4_v_lyrG1_diffmeth <- HM_lyrG1_v_RS7G4_DMG_CG[HM_lyrG1_v_RS7G4_DMG_CG$geneID %in% HM_RS7G4_v_lyrG1_overlap,]
HM_RS7G4_v_lyrG1_diffexp <- HM_lyrG1_v_RS7G4_DEG[HM_lyrG1_v_RS7G4_DEG$geneID %in% HM_RS7G4_v_lyrG1_overlap,]
HM_RS7G4_v_lyrG1_merge <- merge(HM_RS7G4_v_lyrG1_diffmeth, HM_RS7G4_v_lyrG1_diffexp, by = "geneID")
HM_syn1Vpro1_raw <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn1Vpro1_HM/dmrseq/CG_context/parent2_v_allo_sig_diff.txt")
match_start <- match(HM_RS7G4_v_lyrG1_merge$region_start,
HM_syn1Vpro1_raw$start)
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
HM_RS7G4_v_lyrG1_final <- mutate(HM_RS7G4_v_lyrG1_merge, rawDiff =
rawDiff)
ggplot(data = HM_RS7G4_v_lyrG1_merge, mapping = aes(x = logFC,
y = rawDiff)) +
geom_point() +
geom_smooth(method = lm)
HM_syn1Vpro1_raw <- read.delim("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn4Vpro1_HM/dmrseq/CG_context/parent2_v_allo_sig_diff.txt")
match_start <- match(HM_RS7G4_v_lyrG1_merge$region_start,
HM_syn1Vpro1_raw$start)
rawDiff <- HM_syn1Vpro1_raw$rawDiff[match_start]
HM_RS7G4_v_lyrG1_final <- mutate(HM_RS7G4_v_lyrG1_merge, rawDiff =
rawDiff)
ggplot(data = HM_RS7G4_v_lyrG1_merge, mapping = aes(x = logFC,
y = rawDiff)) +
geom_point() +
geom_smooth(method = lm)
library(tidyverse)
library(data.table)
library(patchwork)
setwd("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn1_HMvsLL/dmrseq")
dmrseq_output_CG_AvB <- fread("CG_context/A_v_B_polyploid.txt")
dmrseq_output_CHG_AvB <- fread("CHG_context/A_v_B_polyploid.txt")
dmrseq_output_CHH_AvB <- fread("CHH_context/A_v_B_polyploid.txt")
scaffold_number_CG <- as.integer(str_split_fixed(dmrseq_output_CG_AvB$seqnames, "_", 2)[,2])
scaffold_number_CHG <- as.integer(str_split_fixed(dmrseq_output_CHG_AvB$seqnames, "_", 2)[,2])
scaffold_number_CHH <- as.integer(str_split_fixed(dmrseq_output_CHH_AvB$seqnames, "_", 2)[,2])
dmrseq_output_CG_hal <- dmrseq_output_CG_AvB[scaffold_number_CG < 2240]
dmrseq_output_CG_lyr <- dmrseq_output_CG_AvB[scaffold_number_CG > 2239]
dmrseq_output_CHG_hal <- dmrseq_output_CHG_AvB[scaffold_number_CHG < 2240]
dmrseq_output_CHG_lyr <- dmrseq_output_CHG_AvB[scaffold_number_CHG > 2240]
dmrseq_output_CHH_hal <- dmrseq_output_CHH_AvB[scaffold_number_CHH < 2240]
dmrseq_output_CHH_lyr <- dmrseq_output_CHH_AvB[scaffold_number_CHH > 2240]
dmrseq_output_CG_hal_sig <- dmrseq_output_CG_hal[dmrseq_output_CG_hal$qval<0.05]
dmrseq_output_CHG_hal_sig <- dmrseq_output_CHG_hal[dmrseq_output_CHG_hal$qval<0.05]
dmrseq_output_CHH_hal_sig <- dmrseq_output_CHH_hal[dmrseq_output_CHH_hal$qval<0.05]
dmrseq_output_CG_lyr_sig <- dmrseq_output_CG_lyr[dmrseq_output_CG_lyr$qval<0.05]
dmrseq_output_CHG_lyr_sig <- dmrseq_output_CHG_lyr[dmrseq_output_CHG_lyr$qval<0.05]
dmrseq_output_CHH_lyr_sig <- dmrseq_output_CHH_lyr[dmrseq_output_CHH_lyr$qval<0.05]
setwd("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn4_HMvsLL/dmrseq")
dmrseq_output_CG_AvB <- fread("CG_context/A_v_B_polyploid.txt")
scaffold_number_CG <- as.integer(str_split_fixed(dmrseq_output_CG_AvB$seqnames, "_", 2)[,2])
dmrseq_output_CG_hal <- dmrseq_output_CG_AvB[scaffold_number_CG < 2240]
dmrseq_output_CG_lyr <- dmrseq_output_CG_AvB[scaffold_number_CG > 2239]
dmrseq_output_CG_hal_sig <- dmrseq_output_CG_hal[dmrseq_output_CG_hal$qval<0.05]
dmrseq_output_CG_lyr_sig <- dmrseq_output_CG_lyr[dmrseq_output_CG_lyr$qval<0.05]
HM_hal_lowC_scaffolds  <- read.table("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/HM_RS7_G4_hal_LowCovScaffolds.txt", quote="\"", comment.char="")
HM_lyr_lowC_scaffolds  <- read.table("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/HM_RS7_G4_lyr_LowCovScaffolds.txt", quote="\"", comment.char="")
matchCG <- dmrseq_output_CG_hal_sig$seqnames %in% HM_hal_lowC_scaffolds$V1
dmrseq_output_CG_hal_sig <- dmrseq_output_CG_hal_sig[!matchCG,]
matchCHG <- dmrseq_output_CHG_hal_sig$seqnames %in% HM_hal_lowC_scaffolds$V1
dmrseq_output_CHG_hal_sig <- dmrseq_output_CHG_hal_sig[!matchCHG,]
matchCHH <- dmrseq_output_CHH_hal_sig$seqnames %in% HM_hal_lowC_scaffolds$V1
dmrseq_output_CHH_hal_sig <- dmrseq_output_CHH_hal_sig[!matchCHH,]
CG_hal <- ifelse(dmrseq_output_CG_hal_sig$stat>0, "decrease", "increase")
CHG_hal <- ifelse(dmrseq_output_CHG_hal_sig$stat>0, "decrease", "increase")
CHH_hal <- ifelse(dmrseq_output_CHH_hal_sig$stat>0, "decrease", "increase")
CG_lyr <- ifelse(dmrseq_output_CG_lyr_sig$stat>0, "decrease", "increase")
CHG_lyr <- ifelse(dmrseq_output_CHG_lyr_sig$stat>0, "decrease", "increase")
CHH_lyr <- ifelse(dmrseq_output_CHH_lyr_sig$stat>0, "decrease", "increase")
context <- rep(c("CG", "CHG", "CHH"), 2)
species <- c(rep("halleri", 3), rep("lyrata", 3))
hypo_hyper <- c(rep("hyper", 3), rep("hypo", 3), rep("hyper", 3), rep("hypo", 3))
value <- c(table(CG_hal)[2], table(CHG_hal)[2], table(CHH_hal)[2],
table(CG_hal)[1], table(CHG_hal)[1], table(CHH_hal)[1],
table(CG_lyr)[2], table(CHG_lyr)[2], table(CHH_lyr)[2],
table(CG_lyr)[1], table(CHG_lyr)[1], table(CHH_lyr)[1])
comparison <- c(rep("synthetic_4_HMvLL", 12))
dmrs_context_total <- data.frame(context, species, hypo_hyper, value, comparison)
species.labs <- c(paste0("halleri-side"),
paste0("lyrata-side"))
names(species.labs) <- c("halleri", "lyrata")
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
dmrs_context_total$hypo_hyper <- factor(dmrs_context_total$hypo_hyper,
levels = unique(dmrs_context_total$hypo_hyper))
ggplot(dmrs_context_total, aes(x=context, y=value)) +
geom_col(width = 0.5, show.legend = TRUE, position = "stack",
aes(col = hypo_hyper)) +
#scale_fill_manual(values=cbPalette) +
scale_color_manual(labels = c("hypo", "hyper"), values=c("white", "black")) +
facet_grid(~species, labeller = labeller(species = species.labs)) +
ylab("Number of DMRs") +
theme_bw() +
theme(legend.title = element_blank(), text = element_text(size=25),
legend.text = element_text(size = 15),
strip.background = element_rect(color="white", fill="white", size=1.5, linetype="solid"),
axis.ticks = element_blank()) +
scale_x_discrete(name = "DMR context", breaks = ,
labels = c("CG", "CHG", "CHH", "CG", "CHG", "CHH")) +
ylim(0, 1000) +
ggtitle("Synthetics G4 - HM vs LL")
setwd("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn4_HMvsLL/dmrseq")
dmrseq_output_CG_AvB <- fread("CG_context/A_v_B_polyploid.txt")
dmrseq_output_CHG_AvB <- fread("CHG_context/A_v_B_polyploid.txt")
dmrseq_output_CHH_AvB <- fread("CHH_context/A_v_B_polyploid.txt")
scaffold_number_CG <- as.integer(str_split_fixed(dmrseq_output_CG_AvB$seqnames, "_", 2)[,2])
scaffold_number_CHG <- as.integer(str_split_fixed(dmrseq_output_CHG_AvB$seqnames, "_", 2)[,2])
scaffold_number_CHH <- as.integer(str_split_fixed(dmrseq_output_CHH_AvB$seqnames, "_", 2)[,2])
dmrseq_output_CG_hal <- dmrseq_output_CG_AvB[scaffold_number_CG < 2240]
dmrseq_output_CG_lyr <- dmrseq_output_CG_AvB[scaffold_number_CG > 2239]
dmrseq_output_CHG_hal <- dmrseq_output_CHG_AvB[scaffold_number_CHG < 2240]
dmrseq_output_CHG_lyr <- dmrseq_output_CHG_AvB[scaffold_number_CHG > 2240]
dmrseq_output_CHH_hal <- dmrseq_output_CHH_AvB[scaffold_number_CHH < 2240]
dmrseq_output_CHH_lyr <- dmrseq_output_CHH_AvB[scaffold_number_CHH > 2240]
dmrseq_output_CG_hal_sig <- dmrseq_output_CG_hal[dmrseq_output_CG_hal$qval<0.05]
dmrseq_output_CHG_hal_sig <- dmrseq_output_CHG_hal[dmrseq_output_CHG_hal$qval<0.05]
dmrseq_output_CHH_hal_sig <- dmrseq_output_CHH_hal[dmrseq_output_CHH_hal$qval<0.05]
dmrseq_output_CG_lyr_sig <- dmrseq_output_CG_lyr[dmrseq_output_CG_lyr$qval<0.05]
dmrseq_output_CHG_lyr_sig <- dmrseq_output_CHG_lyr[dmrseq_output_CHG_lyr$qval<0.05]
dmrseq_output_CHH_lyr_sig <- dmrseq_output_CHH_lyr[dmrseq_output_CHH_lyr$qval<0.05]
HM_hal_lowC_scaffolds  <- read.table("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/HM_RS7_G4_hal_LowCovScaffolds.txt", quote="\"", comment.char="")
HM_lyr_lowC_scaffolds  <- read.table("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/HM_RS7_G4_lyr_LowCovScaffolds.txt", quote="\"", comment.char="")
matchCG <- dmrseq_output_CG_hal_sig$seqnames %in% HM_hal_lowC_scaffolds$V1
dmrseq_output_CG_hal_sig <- dmrseq_output_CG_hal_sig[!matchCG,]
matchCHG <- dmrseq_output_CHG_hal_sig$seqnames %in% HM_hal_lowC_scaffolds$V1
dmrseq_output_CHG_hal_sig <- dmrseq_output_CHG_hal_sig[!matchCHG,]
matchCHH <- dmrseq_output_CHH_hal_sig$seqnames %in% HM_hal_lowC_scaffolds$V1
dmrseq_output_CHH_hal_sig <- dmrseq_output_CHH_hal_sig[!matchCHH,]
CG_hal <- ifelse(dmrseq_output_CG_hal_sig$stat>0, "decrease", "increase")
CHG_hal <- ifelse(dmrseq_output_CHG_hal_sig$stat>0, "decrease", "increase")
CHH_hal <- ifelse(dmrseq_output_CHH_hal_sig$stat>0, "decrease", "increase")
CG_lyr <- ifelse(dmrseq_output_CG_lyr_sig$stat>0, "decrease", "increase")
CHG_lyr <- ifelse(dmrseq_output_CHG_lyr_sig$stat>0, "decrease", "increase")
CHH_lyr <- ifelse(dmrseq_output_CHH_lyr_sig$stat>0, "decrease", "increase")
context <- rep(c("CG", "CHG", "CHH"), 2)
species <- c(rep("halleri", 3), rep("lyrata", 3))
hypo_hyper <- c(rep("hyper", 3), rep("hypo", 3), rep("hyper", 3), rep("hypo", 3))
value <- c(table(CG_hal)[2], table(CHG_hal)[2], table(CHH_hal)[2],
table(CG_hal)[1], table(CHG_hal)[1], table(CHH_hal)[1],
table(CG_lyr)[2], table(CHG_lyr)[2], table(CHH_lyr)[2],
table(CG_lyr)[1], table(CHG_lyr)[1], table(CHH_lyr)[1])
comparison <- c(rep("synthetic_4_HMvLL", 12))
dmrs_context_total <- data.frame(context, species, hypo_hyper, value, comparison)
species.labs <- c(paste0("halleri-side"),
paste0("lyrata-side"))
names(species.labs) <- c("halleri", "lyrata")
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
dmrs_context_total$hypo_hyper <- factor(dmrs_context_total$hypo_hyper,
levels = unique(dmrs_context_total$hypo_hyper))
ggplot(dmrs_context_total, aes(x=context, y=value)) +
geom_col(width = 0.5, show.legend = TRUE, position = "stack",
aes(col = hypo_hyper)) +
#scale_fill_manual(values=cbPalette) +
scale_color_manual(labels = c("hypo", "hyper"), values=c("white", "black")) +
facet_grid(~species, labeller = labeller(species = species.labs)) +
ylab("Number of DMRs") +
theme_bw() +
theme(legend.title = element_blank(), text = element_text(size=25),
legend.text = element_text(size = 15),
strip.background = element_rect(color="white", fill="white", size=1.5, linetype="solid"),
axis.ticks = element_blank()) +
scale_x_discrete(name = "DMR context", breaks = ,
labels = c("CG", "CHG", "CHH", "CG", "CHG", "CHH")) +
ylim(0, 1000) +
ggtitle("Synthetics G4 - HM vs LL")
library(edgeR)
?topTags
?plotMD
# This script will compute the density of DMRs
# in homeologous exchanged regions and normal regions
### import libraries
library(ggplot2)
library(GenomicRanges)
### Import files
homeo_HM_overlap_continuous <- read.csv("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/homeo_regions/homeo_HM_overlap_continuous.txt", sep="")
homeo_LL_overlap_continuous <- read.csv("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/homeo_regions/homeo_LL_overlap_continuous.txt", sep="")
nonhomeo_HM_overlap_continuous <- read.csv("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/homeo_regions/nonhomeo_HM_overlap_continuous.txt", sep="")
nonhomeo_LL_overlap_continuous <- read.csv("~/OneDrive/PhD/Project/Chapter_3/coverage_analysis/homeo_regions/nonhomeo_LL_overlap_continuous.txt", sep="")
folder_path <- c("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn4Vpro1_HM/dmrseq/")
HM_RS7_G4_CG <- read.csv(paste0(folder_path, "CG_context/parent1_v_allo.txt"))
HM_RS7_G4_CHG <- read.csv(paste0(folder_path, "CHG_context/parent1_v_allo.txt"))
HM_RS7_G4_CHH <- read.csv(paste0(folder_path, "CHH_context/parent1_v_allo.txt"))
folder_path <- c("~/OneDrive/PhD/Project/Chapter_3/DMR_results/ARPEGGIO_results_syn4Vpro1_LL/dmrseq/")
LL_RS7_G4_CG <- read.csv(paste0(folder_path, "CG_context/parent1_v_allo.txt"))
LL_RS7_G4_CHG <- read.csv(paste0(folder_path, "CHG_context/parent1_v_allo.txt"))
LL_RS7_G4_CHH <- read.csv(paste0(folder_path, "CHH_context/parent1_v_allo.txt"))
### Coordinate converter function to be able to select DMRs
coordinate_converter <- function(dmrseq_output, agp){
### Match old scaffolds to new chromosomes
scaffold_match <- match(dmrseq_output$seqnames, agp$old_scaffold)
### Create vector with new scaffolds and new coordinates
new_scaffolds <- agp$new_scaffold[scaffold_match]
new_start <- agp$start[scaffold_match] + dmrseq_output$start
new_end <- agp$start[scaffold_match] + dmrseq_output$end
### Modify dmrseq output with new coordinates
new_dmrseq_output <- dmrseq_output
new_dmrseq_output$seqnames <- new_scaffolds
new_dmrseq_output$start <- new_start
new_dmrseq_output$end <- new_end
# Selecting only 8 chromosomes
new_dmrseq_output <- new_dmrseq_output %>%
dplyr::filter(seqnames=="scaffold_1_RagTag" |
seqnames=="scaffold_2_RagTag" |
seqnames=="scaffold_3_RagTag" |
seqnames=="scaffold_4_RagTag" |
seqnames=="scaffold_5_RagTag" |
seqnames=="scaffold_6_RagTag" |
seqnames=="scaffold_7_RagTag" |
seqnames=="scaffold_8_RagTag")
### return file with new coordinates
return(new_dmrseq_output)
}
agp <- read.delim("~/OneDrive/PhD/Project/Chapter2/AssemblyMapping/Ahal_mm2_tiling.agp",
header=FALSE, comment.char="#")
names(agp) <- c("new_scaffold",
"start",
"end",
"n",
"WU",
"old_scaffold",
"type",
"length",
"orientiation")
new_HM_RS7_G4_CG <- coordinate_converter(HM_RS7_G4_CG, agp)
new_HM_RS7_G4_CHG <- coordinate_converter(HM_RS7_G4_CHG, agp)
new_HM_RS7_G4_CHH <- coordinate_converter(HM_RS7_G4_CHH, agp)
new_LL_RS7_G4_CG <- coordinate_converter(LL_RS7_G4_CG, agp)
new_LL_RS7_G4_CHG <- coordinate_converter(LL_RS7_G4_CHG, agp)
new_LL_RS7_G4_CHH <- coordinate_converter(LL_RS7_G4_CHH, agp)
## merge all contexts and select significant regions only
all_HM_RS7_G4 <- rbind(new_HM_RS7_G4_CG,
new_HM_RS7_G4_CHG,
new_HM_RS7_G4_CHH)
all_LL_RS7_G4 <- rbind(new_LL_RS7_G4_CG,
new_LL_RS7_G4_CHG,
new_LL_RS7_G4_CHH)
all_HM_RS7_G4_sig <- filter(all_HM_RS7_G4, qval < 0.05)
all_LL_RS7_G4_sig <- filter(all_LL_RS7_G4, qval < 0.05)
## convert regions to Granges objects to find overlap with
## homeo or non homeo regions
all_HM_RS7_G4_sig_G <- GRanges(seqnames = all_HM_RS7_G4_sig$seqnames,
ranges = IRanges(start = all_HM_RS7_G4_sig$start,
end = all_HM_RS7_G4_sig$end))
all_LL_RS7_G4_sig_G <- GRanges(seqnames = all_LL_RS7_G4_sig$seqnames,
ranges = IRanges(start = all_LL_RS7_G4_sig$start,
end = all_LL_RS7_G4_sig$end))
homeo_HM_overlap_continuous_G <- GRanges(seqnames = homeo_HM_overlap_continuous$seqnames,
ranges = IRanges(start = homeo_HM_overlap_continuous$start,
end = homeo_HM_overlap_continuous$end))
homeo_LL_overlap_continuous_G <- GRanges(seqnames = homeo_LL_overlap_continuous$seqnames,
ranges = IRanges(start = homeo_LL_overlap_continuous$start,
end = homeo_LL_overlap_continuous$end))
nonhomeo_HM_overlap_continuous_G <- GRanges(seqnames = nonhomeo_HM_overlap_continuous$start_scaffold,
ranges = IRanges(start = nonhomeo_HM_overlap_continuous$start_coordinate,
end = nonhomeo_HM_overlap_continuous$end_coordinate))
nonhomeo_LL_overlap_continuous_G <- GRanges(seqnames = nonhomeo_LL_overlap_continuous$start_scaffold,
ranges = IRanges(start = nonhomeo_LL_overlap_continuous$start_coordinate,
end = nonhomeo_LL_overlap_continuous$end_coordinate))
# Check overlaps
DMRs_homeo_HM <- findOverlaps(all_HM_RS7_G4_sig_G, homeo_HM_overlap_continuous_G)
DMRhomeo_HM <- all_HM_RS7_G4_sig[DMRs_homeo_HM@from,]
DMRs_nonhomeo_HM <- findOverlaps(all_HM_RS7_G4_sig_G,
nonhomeo_HM_overlap_continuous_G)
DMRnonhomeo_HM <- all_HM_RS7_G4_sig[DMRs_nonhomeo_HM@from,]
DMRs_homeo_LL <- findOverlaps(all_LL_RS7_G4_sig_G, homeo_LL_overlap_continuous_G)
DMRhomeo_LL <- all_LL_RS7_G4_sig[DMRs_homeo_LL@from,]
DMRs_nonhomeo_LL <- findOverlaps(all_LL_RS7_G4_sig_G,
nonhomeo_LL_overlap_continuous_G)
DMRnonhomeo_LL <- all_LL_RS7_G4_sig[DMRs_nonhomeo_LL@from,]
# Let's first look at DMR density over the whole range
homeo_range_HM <- sum(homeo_HM_overlap_continuous$end -
homeo_HM_overlap_continuous$start)
homeo_range_LL <- sum(homeo_LL_overlap_continuous$end -
homeo_LL_overlap_continuous$start)
nonhomeo_range_HM <- sum(nonhomeo_HM_overlap_continuous$end_coordinate -
nonhomeo_HM_overlap_continuous$start_coordinate)
nonhomeo_range_LL <- sum(nonhomeo_LL_overlap_continuous$end_coordinate -
nonhomeo_LL_overlap_continuous$start_coordinate)
global_density_homeo_HM <- nrow(DMRhomeo_HM) / homeo_range_HM
global_density_homeo_LL <- nrow(DMRhomeo_LL) / homeo_range_LL
global_density_nonhomeo_HM <- nrow(DMRhomeo_HM) / nonhomeo_range_HM
global_density_nonhomeo_LL <- nrow(DMRhomeo_LL) / nonhomeo_range_LL
global_density_homeo_HM / global_density_nonhomeo_HM
global_density_homeo_LL / global_density_nonhomeo_LL
head(DMRhomeo_HM)
nrow(DMRhomeo_HM)
nrow(DMRnonhomeo_HM)
homeo_range_HM / nonhomeo_range_HM
0.2730627
0.2730627 * 0.6799994
